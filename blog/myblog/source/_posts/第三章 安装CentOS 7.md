---
title: 第三章 安装CentOS 7
data: 2021-3-13 20:14
tags: Linux
---

## 3.1 练习机的规划--尤其是分区参数

- Linux主机的角色定位：主要用于练习，所以所有的数据都会安装进来。
- 选择的distribution：对于Linux的定位为“服务器”的角色，因此选择号称完全相容于商业版RHEL的社群版本--CentOS7版。
- 计算机系统硬件配备：使用虚拟机练习
- 磁盘分区配置：默认是MBR模式，可是使用命令强制使用GPT

|所需目录/设备|磁盘容量|文件系统|分区格式|
 |--|--|--|--|
 |BIOS boot|2MB|系统自订|主分区|
 |/boot|1GB|xfs|主分区|
 |/|10GB|xfs|LVM方式|
 |/home|5GB|xfs|LVM方式|
 |swap|1GB|swap|LVM方式|
 
- 开机管理程序（boot loader）：
- 选择软件：因为练习机是作为服务器使用的，所以可能会使用图形接口来管理系统

## 3.2 开始安装CentOS 7

主要的安装步骤是：
1. 调整开机媒体（BIOS）
2. 选择安装模式与开机
3. 选择语系数据
4. 软件选择
5. 磁盘分区
6. 开机管理程序、网络、时区设置与root密码
7. 安装后的首次设置

### 3.2.1 调整开机媒体（BIOS）与虚拟机创建流程

#### 在VMware上面创建虚拟机的流程

1. 打开软件，在主页上点击新建虚拟机
2. 选择Linux的ISO镜像文件
3. 设置CPU数量、内存数据、磁盘容量（根据实体机的情况分配，当然越大越好）
4. 网卡选择桥接模式
5. 其他默认即可

### 3.2.2选择安装模式与开机 -inst.gpt

安装画面从上到下分别是：

1. 正常安装CentOS 7
2. 测试光盘后安装CentOS 7
3. 进入除错模式，选择此模式后出现更多的选项，分别是：
   - 以基本图形接口安装CentOS 7（使用标准显卡来设置安装流程图示）；
   - 救援CentOS系统
   - 执行内存测试（Run a memory test）
   - 由本机磁盘正常开机，不由光盘开机

#### 加入强制使用GPT分区的安装参数

硬盘小于2TB的话，会默认使用MBR模式来安装，如果想要强制使用GPT分区的话，则需要：

1. 使用方向键将光标移动到“Install CentOS 7”的选项上
2. 按下`TAb`键，让光标到画面最下方等待输入的核心参数
3. 在出现的画面中，输入`inst.gpt`

过一会后便会进入系统，进入系统后，会提示选择语言，直接选择中文简体就就可以了。

### 3.2.3 设置时区、语系与键盘配置

时区选择中国上海即可，选择时区后选择键盘配置

### 3.2.4 安装来源设置与软件选择

因为是光盘安装，所以这里默认选择的就是光盘，如果设置好了网络，那么也可以使用网络安装

软件选择上，选择还有GUI的服务器，附加原件里选择兼容性程序和开发工具

### 3.2.5 磁盘分区与文件系统设置

设备类型一般有三种：

- 标准分区：类似/dev/vda1之类的分区
- LVM：这是一种可以弹性增加/削减文件系统容量的设备设置
- LVM 紧张供应：这个是 LVM 的进阶版！与传统 LVM 直接分配固定的容量不同， 这个“ LVM 紧张供应”的项目，可以让你在使用多少容量才分配磁盘多少容量给你，所以如果 LVM 设备内的数据量较少，那么你的磁盘其实还可以作更多的数据储存！ 而不会被平白无故的占用！这部份我们也在后续谈到 LVM 的时候再来强调！

各个文件的系统项目：

- ext2/ext3/ext4：Linux早期适用的文件系统类型。
- swap：将磁盘仿真成内存
- BIOS Boot：就是 GPT 分区表可能会使用到的项目，若你使用 MBR 分区，那就不需要这个项目了！
- xfs：这个是CentOS默认的文件系统
- vfat：同时被Linux与Windows所支持的文件系统类型。

### 3.2.6 核心管理与网络设置

KDUMP可以将Linux死机时的内存里的数据存储起来，这个核心比较面向核心开发者。使用默认值就好。

网络设置选项卡里，可以修改当前的网络和主机名称

### 3.2.7 开始安装、设置root密码与新增可切换身份之一般用户

点击开始安装后，会出现用户设定的界面

首先设置ROOT用户的密码，然后创建以个日常使用的账户

### 3.2.8 准备使用系统前的授权同意

安装完成后系统会进入第一次使用的授权同意画面。点击同意后即可开机

开机后就可以看到登陆界面了。

> 刚刚所有的操作都保存到了/root/anaconda-ks.cfg这个文件中。如果想要重建一个一模一样的系统时，就可以通过这个文件来制作，也可以Google搜索一个kickstart关键字

### 3.2.9 其他功能：RAM testing，安装笔记本电脑的核心参数（Option）

- 内存压力测试
- 安装笔记本电脑或其他类PC计算机的参数

## 3.3 多重开机安装流程与管理（Option）

### 3.3.1 安装CentOS 7 + Windows 的规划

### 3.3.2 进阶安装CentOS 7 与 Windows

### 3.3.3 救援MBR内部的开机管理程序与设置多重开机菜单

#### 后续维护的注意事项

多重开机设置完毕后请特别注意， （1）Windows的环境中最好将Linux的根目录与swap取消挂载，否则未来你打开文件资源管理器时， 该软件会要求你“格式化！”如果一个不留神，你的Linux系统就毁了。 （2）你的Linux不可以随便的删除！ 因为grub会去读取Linux根目录下的/boot/目录内容，如果你将Linux移除了，你的Windows也就无法开机了！ 因为整个开机菜单都会不见！

## 3.4 重点回顾

- 不论你要安装什么样的Linux操作系统角色，都应该要事先规划例如分区、开机管理程序等；
- 建议练习机安装时的磁盘分区能有/, /boot, /home, swap四个分区
- 安装CentOS7 会主动依据你的磁盘容量判断要用MBR或GPT分区方式，你也可以强迫使用GPT；
- 若笔记本安装失败，可以尝试在开机时加入“linux nofb apm=off acpi=off”来关闭省电功能；
- 安装过程进入分区后，请以“自定义的分区模式”来处理自己规划的分区方式
- 在安装的过程中，可以创建立即卷轴管理员（LVM）
- 一般要求撒p应该要是1.5~2倍的实体内存量，但即使没有swap依旧能够安装与运行Linux操作系统；
- CentOS7默认使用xfs作为文件系统
- 没有连上Internet时，可以尝试关闭防火墙，但SELinux最好选择“强制”状态；
- 设置时不要选择启动kdump，因为那是给核心开发者查阅死机数据的；
- 可以加入时间服务器来同步化时间，台湾可以选择tock.stdtime.gov这一部；
- 尽量使用一般用户来操作Linux，有必要在转换成root即可；
- 即使是练习机，在创建root密码时，建议依旧能够保持良好的密码规范，不要随便设置。

